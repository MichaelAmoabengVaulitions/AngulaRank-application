<!DOCTYPE html>
<html>
<head>
  <title>AngulaRank-application</title>
  <link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" />
</head>
<body>
  <!--Main App area-->
  <div class="container">
    <h1>Repository Contributors</h1>
    <hr/>
    <div class="page"></div>
  </div>

  <!--Including necessary dependencies-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>

  <!--Backbone.js code/ Doing everything inline but module system is recommended-->
  <script>

   //Adding an Ajax prefilter function because when requests are being fired to localhost
   /*$.ajaxPrefilter(function (options, originalOptions, jqXHR) {
     options.url = "https://github.com" + options.url;
   });*/
   //Backbone contributors collection from GitHub developer API
   var Item = Backbone.Model.extend();
   var Contributors = Backbone.Collection.extend({
     url: 'https://github.com/orgs/angular/people',
     parse: function(response) {
       return response.results;
   },

   sync: function(method, model, options) {
       var that = this;
       var params = _.extend({
           type: 'GET',
           dataType: 'jsonp',
           url: that.url,
           processData: false
       }, options);

       return $.ajax(params);
   }
   });


   //Backbone view to render list of Angular repo contributors
   var ContributorsList = Backbone.View.extend({
     el: '.page',
     render: function () {
       var that = this;
       var contributors = new Contributors();
       contributors.fetch({
         success: function () {
           that.$el.html('!List of contributors should show here...');
         }
       })
     }
   });

    //Router to load the Homepage
    var Router = Backbone.Router.extend({
      routes: {
        '':'home'
      }
    });

    //Creating instance of View to render list of Angular repo contributors
    var contributorsList = new ContributorsList();

    //Creating instance of Homepage Router
    var router = new Router();
    router.on('route:home', function () {
      contributorsList.render();
    });
    //Kickstart backbone
    Backbone.history.start();
  </script>

</body>
</html>
